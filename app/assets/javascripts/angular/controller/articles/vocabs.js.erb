app.controller('VocabsCtrl', ['$scope', '$http', '$location', function($scope, $http, $location) {

  var url = "<%= ENV['URL'] %>" || "http://localhost:3000";

  $scope.form = {};
  $scope.newVocab = {};
  $scope.vocabsArr = [];

  // Get all the vocabs from the backend
  $http.get(url + '/vocabs').success(function(response){
    $scope.vocabsArr = response;
  });

  // when click in the form to add, push to backend
  // if ok, push into vocabsArr
  $scope.form.create = function(){

    var data = { vocab: $scope.newVocab };

    if ($scope.newVocab.id) {
      $http.patch(url + '/vocabs/' + $scope.newVocab.id, data).success(function(response){
        console.log(response);
        $scope.newVocab = {};
      });

    } else {
      $http.post(url + '/vocabs', data).success(function(response){
        console.log(response);
        $scope.vocabsArr.push($scope.newVocab);
        $scope.newVocab = {};
      });
    }
  };

  $scope.delete = function(arrayIndex, vocabId) {
    $http.delete(url + '/vocabs/' + vocabId).success(function(response) {
      console.log(response);
      $scope.vocabsArr.splice(arrayIndex, 1);
    });
  };

  $scope.edit = function(arrayIndex) {
    $scope.newVocab = $scope.vocabsArr[arrayIndex];
  };
}])
